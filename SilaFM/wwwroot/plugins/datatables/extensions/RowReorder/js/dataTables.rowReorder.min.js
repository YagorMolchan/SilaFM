(function(n){typeof define=="function"&&define.amd?define(["jquery","datatables.net"],function(t){return n(t,window,document)}):typeof exports=="object"?module.exports=function(t,i){return t||(t=window),i&&i.fn.dataTable||(i=require("datatables.net")(t,i).$),n(i,t,t.document)}:n(jQuery,window,document)})(function(n,t,i,r){"use strict";var f=n.fn.dataTable,u=function(t,i){if(!f.versionCheck||!f.versionCheck("1.10.8"))throw"DataTables RowReorder requires DataTables 1.10.8 or newer";this.c=n.extend(!0,{},f.defaults.rowReorder,u.defaults,i);this.s={bodyTop:null,dt:new f.Api(t),getDataFn:f.ext.oApi._fnGetObjectDataFn(this.c.dataSrc),middles:null,scroll:{},scrollInterval:null,setDataFn:f.ext.oApi._fnSetObjectDataFn(this.c.dataSrc),start:{top:0,left:0,offsetTop:0,offsetLeft:0,nodes:[]},windowHeight:0,documentOuterHeight:0,domCloneOuterHeight:0};this.dom={clone:null,dtScroll:n("div.dataTables_scrollBody",this.s.dt.table().container())};var r=this.s.dt.settings()[0],e=r.rowreorder;if(e)return e;r.rowreorder=this;this._constructor()},e;n.extend(u.prototype,{_constructor:function(){var i=this,t=this.s.dt,r=n(t.table().node());r.css("position")==="static"&&r.css("position","relative");n(t.table().container()).on("mousedown.rowReorder touchstart.rowReorder",this.c.selector,function(r){if(i.c.enable){var f=n(this).closest("tr"),u=t.row(f);if(u.any())return i._emitEvent("pre-row-reorder",{node:u.node(),index:u.index()}),i._mouseDown(r,f),!1}});t.on("destroy.rowReorder",function(){n(t.table().container()).off(".rowReorder");t.off(".rowReorder")})},_cachePositions:function(){var r=this.s.dt,f=n(r.table().node()).find("thead").outerHeight(),e=n.unique(r.rows({page:"current"}).nodes().toArray()),u=n.map(e,function(t){return n(t).position().top-f}),o=n.map(u,function(t,i){return u.length<i-1?(t+u[i+1])/2:(t+t+n(r.row(":last-child").node()).outerHeight())/2});this.s.middles=o;this.s.bodyTop=n(r.table().body()).offset().top;this.s.windowHeight=n(t).height();this.s.documentOuterHeight=n(i).outerHeight()},_clone:function(t){var r=this.s.dt,i=n(r.table().node().cloneNode(!1)).addClass("dt-rowReorder-float").append("<tbody/>").append(t.clone(!1)),u=t.outerWidth(),f=t.outerHeight(),e=t.children().map(function(){return n(this).width()});i.width(u).height(f).find("tr").children().each(function(n){this.style.width=e[n]+"px"});i.appendTo("body");this.dom.clone=i;this.s.domCloneOuterHeight=i.outerHeight()},_clonePosition:function(n){var t=this.s.start,f=this._eventToPage(n,"Y")-t.top,e=this._eventToPage(n,"X")-t.left,r=this.c.snapX,u,i=f+t.offsetTop;u=r===!0?t.offsetLeft:typeof r=="number"?t.offsetLeft+r:e+t.offsetLeft;i<0?i=0:i+this.s.domCloneOuterHeight>this.s.documentOuterHeight&&(i=this.s.documentOuterHeight-this.s.domCloneOuterHeight);this.dom.clone.css({top:i,left:u})},_emitEvent:function(t,i){this.s.dt.iterator("table",function(r){n(r.nTable).triggerHandler(t+".dt",i)})},_eventToPage:function(n,t){return n.type.indexOf("touch")!==-1?n.originalEvent.touches[0]["page"+t]:n["page"+t]},_mouseDown:function(r,u){var o=this,h=this.s.dt,e=this.s.start,s=u.offset(),f;e.top=this._eventToPage(r,"Y");e.left=this._eventToPage(r,"X");e.offsetTop=s.top;e.offsetLeft=s.left;e.nodes=n.unique(h.rows({page:"current"}).nodes().toArray());this._cachePositions();this._clone(u);this._clonePosition(r);this.dom.target=u;u.addClass("dt-rowReorder-moving");n(i).on("mouseup.rowReorder touchend.rowReorder",function(n){o._mouseUp(n)}).on("mousemove.rowReorder touchmove.rowReorder",function(n){o._mouseMove(n)});n(t).width()===n(i).width()&&n(i.body).addClass("dt-rowReorder-noOverflow");f=this.dom.dtScroll;this.s.scroll={windowHeight:n(t).height(),windowWidth:n(t).width(),dtTop:f.length?f.offset().top:null,dtLeft:f.length?f.offset().left:null,dtHeight:f.length?f.outerHeight():null,dtWidth:f.length?f.outerWidth():null}},_mouseMove:function(t){var r,o,f;this._clonePosition(t);var s=this._eventToPage(t,"Y")-this.s.bodyTop,u=this.s.middles,i=null,e=this.s.dt,h=e.table().body();for(r=0,o=u.length;r<o;r++)if(s<u[r]){i=r;break}i===null&&(i=u.length);(this.s.lastInsert===null||this.s.lastInsert!==i)&&(i===0?this.dom.target.prependTo(h):(f=n.unique(e.rows({page:"current"}).nodes().toArray()),i>this.s.lastInsert?this.dom.target.insertAfter(f[i-1]):this.dom.target.insertBefore(f[i])),this._cachePositions(),this.s.lastInsert=i);this._shiftScroll(t)},_mouseUp:function(){var e=this,r=this.s.dt,t,o,h=this.c.dataSrc,v,y;this.dom.clone.remove();this.dom.clone=null;this.dom.target.removeClass("dt-rowReorder-moving");n(i).off(".rowReorder");n(i.body).removeClass("dt-rowReorder-noOverflow");clearInterval(this.s.scrollInterval);this.s.scrollInterval=null;var s=this.s.start.nodes,u=n.unique(r.rows({page:"current"}).nodes().toArray()),c={},f=[],l=[],a=this.s.getDataFn,b=this.s.setDataFn;for(t=0,o=s.length;t<o;t++)if(s[t]!==u[t]){var p=r.row(u[t]).id(),k=r.row(u[t]).data(),w=r.row(s[t]).data();p&&(c[p]=a(w));f.push({node:u[t],oldData:a(k),newData:a(w),newPosition:t,oldPosition:n.inArray(u[t],s)});l.push(u[t])}v=[f,{dataSrc:h,nodes:l,values:c,triggerRow:r.row(this.dom.target)}];this._emitEvent("row-reorder",v);y=function(){if(e.c.update){for(t=0,o=f.length;t<o;t++){var n=r.row(f[t].node),i=n.data();b(i,f[t].newData);r.columns().every(function(){this.dataSrc()===h&&r.cell(f[t].node,this.index()).invalidate("data")})}e._emitEvent("row-reordered",v);r.draw(!1)}};this.c.editor?(this.c.enable=!1,this.c.editor.edit(l,!1,n.extend({submit:"changed"},this.c.formOptions)).multiSet(h,c).one("submitUnsuccessful.rowReorder",function(){r.draw(!1)}).one("submitSuccess.rowReorder",function(){y()}).one("submitComplete",function(){e.c.enable=!0;e.c.editor.off(".rowReorder")}).submit()):y()},_shiftScroll:function(n){var h=this,c=this.s.dt,t=this.s.scroll,o=!1,r=5,u=65,s=n.pageY-i.body.scrollTop,f,e;s<u?f=r*-1:s>t.windowHeight-u&&(f=r);t.dtTop!==null&&n.pageY<t.dtTop+u?e=r*-1:t.dtTop!==null&&n.pageY>t.dtTop+t.dtHeight-u&&(e=r);f||e?(t.windowVert=f,t.dtVert=e,o=!0):this.s.scrollInterval&&(clearInterval(this.s.scrollInterval),this.s.scrollInterval=null);!this.s.scrollInterval&&o&&(this.s.scrollInterval=setInterval(function(){if(t.windowVert&&(i.body.scrollTop+=t.windowVert),t.dtVert){var n=h.dom.dtScroll[0];t.dtVert&&(n.scrollTop+=t.dtVert)}},20))}});u.defaults={dataSrc:0,editor:null,enable:!0,formOptions:{},selector:"td:first-child",snapX:!1,update:!0};e=n.fn.dataTable.Api;e.register("rowReorder()",function(){return this});e.register("rowReorder.enable()",function(n){return n===r&&(n=!0),this.iterator("table",function(t){t.rowreorder&&(t.rowreorder.c.enable=n)})});e.register("rowReorder.disable()",function(){return this.iterator("table",function(n){n.rowreorder&&(n.rowreorder.c.enable=!1)})});u.version="1.2.3";n.fn.dataTable.RowReorder=u;n.fn.DataTable.RowReorder=u;n(i).on("init.dt.dtr",function(t,i){var r,e,o;t.namespace==="dt"&&(r=i.oInit.rowReorder,e=f.defaults.rowReorder,(r||e)&&(o=n.extend({},r,e),r!==!1&&new u(i,o)))});return u});
//# sourceMappingURL=dataTables.rowReorder.min.js.map
